module Klank.Studio.SilentNight.Stars where

import Prelude
import Color (rgb)
import Data.Int (floor)
import Graphics.Painting (Painting, circle, fillColor, filled)
import Klank.Studio.SilentNight.Util (calcSlope)
import Math (sin, pi)

-- print(",".join(["{x:"+str(random.random())+",y:"+str(random.random())+",f: \\x -> "+str(random.random()*0.9+0.1)+" * sin ("+str(random.random()*0.6 + 0.1)+" * (x + "+str(random.random())+") * pi) }" for x in range(100)]))
starDs :: Array { x :: Number, y :: Number, f :: Number -> Number }
starDs = [ { x: 0.7998979153795341, y: 0.08385139594872981, f: \x -> 0.7657069009122556 * sin (0.12048910397521838 * (x + 0.9235025221582407) * pi) }, { x: 0.1889061340397945, y: 0.41662576058498235, f: \x -> 0.1415196387959073 * sin (0.5683357566654806 * (x + 0.4140936479451277) * pi) }, { x: 0.6415434619211883, y: 0.5708146975512279, f: \x -> 0.11577248196435784 * sin (0.29554293868038256 * (x + 0.3836381290510813) * pi) }, { x: 0.46408624003822874, y: 0.5352411436249525, f: \x -> 0.27899259750022887 * sin (0.6168518732109306 * (x + 0.377444452261138) * pi) }, { x: 0.9372148362501318, y: 0.3739296461256748, f: \x -> 0.671489098410653 * sin (0.4822310763852671 * (x + 0.3908243855120592) * pi) }, { x: 0.9677579259565381, y: 0.07151980503063837, f: \x -> 0.9752455547563101 * sin (0.6051350059573541 * (x + 0.46951319522277657) * pi) }, { x: 0.5491926546092344, y: 0.07374039190919535, f: \x -> 0.33536560976485197 * sin (0.53634515525111 * (x + 0.3411527658666662) * pi) }, { x: 0.522532549928989, y: 0.24000747216531726, f: \x -> 0.6849413502333674 * sin (0.25061020850894333 * (x + 0.2704271222503388) * pi) }, { x: 0.676735264877141, y: 0.154014527584188, f: \x -> 0.643492816957883 * sin (0.4999621556849063 * (x + 0.23972440926252403) * pi) }, { x: 0.022005599332260095, y: 0.4517846398419565, f: \x -> 0.9780033023620383 * sin (0.5690010434724488 * (x + 0.4700260516669268) * pi) }, { x: 0.6623321309130382, y: 0.1538961699400414, f: \x -> 0.39547598751018875 * sin (0.35752515144399377 * (x + 0.8345066395190842) * pi) }, { x: 0.07008140643788907, y: 0.5088425430429082, f: \x -> 0.938078599349549 * sin (0.21111028367327936 * (x + 0.8390425040791938) * pi) }, { x: 0.8183208236713514, y: 0.12015800392666187, f: \x -> 0.8959988138316818 * sin (0.6783042097542152 * (x + 0.003916202043623196) * pi) }, { x: 0.6567155163250299, y: 0.8911844616174074, f: \x -> 0.23654036104506207 * sin (0.2682238556417563 * (x + 0.4334644233731685) * pi) }, { x: 0.6635142395130955, y: 0.16220416064115362, f: \x -> 0.8813181743932739 * sin (0.545982341474434 * (x + 0.8337268747684451) * pi) }, { x: 0.27523028020466733, y: 0.01542831693086355, f: \x -> 0.8125688271194221 * sin (0.11256935190258262 * (x + 0.6476702955558028) * pi) }, { x: 0.5999468031487667, y: 0.9508123847205505, f: \x -> 0.12455506698851554 * sin (0.16642138506387108 * (x + 0.9842802977680329) * pi) }, { x: 0.5264600473652116, y: 0.2521314595090074, f: \x -> 0.6004655754729078 * sin (0.5488467917947338 * (x + 0.4100251478253423) * pi) }, { x: 0.2368072536753597, y: 0.3972845965548708, f: \x -> 0.7391259416146705 * sin (0.43050261122448596 * (x + 0.3697052483399993) * pi) }, { x: 0.17679605291326028, y: 0.6268540032189557, f: \x -> 0.6546348882779175 * sin (0.6721869642094553 * (x + 0.24128601888888124) * pi) }, { x: 0.8743480466826442, y: 0.0840467624458574, f: \x -> 0.48785103770632665 * sin (0.3933065653420563 * (x + 0.7481526400188201) * pi) }, { x: 0.061704426811517776, y: 0.34095357496002165, f: \x -> 0.7952378622812539 * sin (0.2073614887237352 * (x + 0.07236472200581767) * pi) }, { x: 0.046728095535261915, y: 0.3557906691124455, f: \x -> 0.8471468676835398 * sin (0.6936312563009017 * (x + 0.8884226981678148) * pi) }, { x: 0.9420065262296728, y: 0.46984187619709383, f: \x -> 0.9148056281198275 * sin (0.21228333966864504 * (x + 0.12171006947395191) * pi) }, { x: 0.22828963814693148, y: 0.5936010890996245, f: \x -> 0.5869924335309348 * sin (0.6760951901932156 * (x + 0.42581741442330057) * pi) }, { x: 0.9448422412741705, y: 0.847273328594833, f: \x -> 0.1444443072829259 * sin (0.564055969475472 * (x + 0.23828946968648346) * pi) }, { x: 0.026017619239415812, y: 0.38784732596558724, f: \x -> 0.40568046115459055 * sin (0.5429357146134501 * (x + 0.17243981005583087) * pi) }, { x: 0.8600314612590836, y: 0.16872127332155784, f: \x -> 0.5243336361413855 * sin (0.5770135444505058 * (x + 0.5096273590873813) * pi) }, { x: 0.6380405298096601, y: 0.47804272716920826, f: \x -> 0.9577493093614781 * sin (0.2636125952601193 * (x + 0.22133762993410544) * pi) }, { x: 0.9623176544984414, y: 0.5731719748334171, f: \x -> 0.8510815994212508 * sin (0.23713905867729537 * (x + 0.9659410292888134) * pi) }, { x: 0.2715621864828037, y: 0.5746086436300603, f: \x -> 0.2476824596259333 * sin (0.6883522844630905 * (x + 0.8934386328562979) * pi) }, { x: 0.9163545335851067, y: 0.5876324876520401, f: \x -> 0.29767964201568 * sin (0.32407987185183196 * (x + 0.5624478725260176) * pi) }, { x: 0.5121105811687144, y: 0.5976398842996643, f: \x -> 0.9487706274379716 * sin (0.3782745410559547 * (x + 0.005825894962646516) * pi) }, { x: 0.42866822912910885, y: 0.6830883083393303, f: \x -> 0.22875670760621292 * sin (0.1725422234511803 * (x + 0.4988007813609098) * pi) }, { x: 0.581878431057003, y: 0.9246881434525345, f: \x -> 0.5571826049082016 * sin (0.664291356515955 * (x + 0.4928719048473047) * pi) }, { x: 0.3356527164199967, y: 0.29328180629071976, f: \x -> 0.845038335641492 * sin (0.695613646890855 * (x + 0.9700923098200159) * pi) }, { x: 0.10749775381328286, y: 0.5554202833939391, f: \x -> 0.739285784528385 * sin (0.6469822932763877 * (x + 0.17466536383933384) * pi) }, { x: 0.8950320550823506, y: 0.6678599725651887, f: \x -> 0.503171785472261 * sin (0.28611277693258097 * (x + 0.6473420586463666) * pi) }, { x: 0.1443247940739063, y: 0.010924436297578888, f: \x -> 0.6986998672144634 * sin (0.17255867274134484 * (x + 0.12993132146898623) * pi) }, { x: 0.2791503707404528, y: 0.06312099128646453, f: \x -> 0.36429082463506834 * sin (0.34196259679059626 * (x + 0.6979922700561009) * pi) }, { x: 0.9285299556309622, y: 0.10161382562297627, f: \x -> 0.8084105943491684 * sin (0.3347280804116324 * (x + 0.649834380138763) * pi) }, { x: 0.5087841904358481, y: 0.5148341219339472, f: \x -> 0.12821142080843256 * sin (0.6436397049542052 * (x + 0.49377239663519) * pi) }, { x: 0.5767279353705533, y: 0.5017259429620036, f: \x -> 0.7074152315694675 * sin (0.24359373059476075 * (x + 0.3640710968785963) * pi) }, { x: 0.3572829307534393, y: 0.07930845199331438, f: \x -> 0.12272185939340002 * sin (0.21496787160199268 * (x + 0.8232597611434008) * pi) }, { x: 0.3045478568273394, y: 0.15189984836967618, f: \x -> 0.44456300688412687 * sin (0.5905856604494417 * (x + 0.6019971776570228) * pi) }, { x: 0.43551591756677743, y: 0.7888726012495775, f: \x -> 0.39358983003016523 * sin (0.46177449026369366 * (x + 0.6330979653144985) * pi) }, { x: 0.8996122943728967, y: 0.4193294174077634, f: \x -> 0.20922101207535942 * sin (0.2505708338272897 * (x + 0.6669132311420939) * pi) }, { x: 0.006809687407536957, y: 0.2591751351787317, f: \x -> 0.4990002170158462 * sin (0.16376093348549342 * (x + 0.9917153566334772) * pi) }, { x: 0.28360533801009014, y: 0.8965273384199693, f: \x -> 0.832548216777215 * sin (0.6968597343485691 * (x + 0.6522250227849495) * pi) }, { x: 0.11768473063078866, y: 0.47431612674759016, f: \x -> 0.3069972229715307 * sin (0.35402930954677736 * (x + 0.2598129062355331) * pi) }, { x: 0.9605409025944893, y: 0.9210189781644056, f: \x -> 0.13767653252020387 * sin (0.645397983120965 * (x + 0.20332445324936355) * pi) }, { x: 0.5802648295815812, y: 0.32188272064836765, f: \x -> 0.7926623083133738 * sin (0.5024237429565865 * (x + 0.43358317968813154) * pi) }, { x: 0.460669273896289, y: 0.826858493037314, f: \x -> 0.6875062564366267 * sin (0.32204424860440284 * (x + 0.6846140018360137) * pi) }, { x: 0.49649673809381545, y: 0.5368631031674957, f: \x -> 0.45981852239312815 * sin (0.4007905113743796 * (x + 0.3419384588612011) * pi) }, { x: 0.014953390603937744, y: 0.7378416524667052, f: \x -> 0.6140466078126797 * sin (0.4870594133670276 * (x + 0.5499076425091735) * pi) }, { x: 0.9651492489337455, y: 0.034190311101410464, f: \x -> 0.680725250861211 * sin (0.1404764045758468 * (x + 0.027344375850516744) * pi) }, { x: 0.3489646579749772, y: 0.45094294411398583, f: \x -> 0.4762308773272914 * sin (0.47885316186142957 * (x + 0.4348305860227125) * pi) }, { x: 0.721516436343126, y: 0.30602540798118605, f: \x -> 0.9539093982726269 * sin (0.12257732836191289 * (x + 0.3236116142830592) * pi) }, { x: 0.0361505728383702, y: 0.22671487550392044, f: \x -> 0.5470863801997212 * sin (0.2267991542971995 * (x + 0.9817698978873135) * pi) }, { x: 0.383638361887656, y: 0.3918972451520907, f: \x -> 0.34106319921048894 * sin (0.6698729229823568 * (x + 0.9500835732982084) * pi) }, { x: 0.19432877382630098, y: 0.9522640114916134, f: \x -> 0.5234030615472549 * sin (0.29322018355964974 * (x + 0.3719893915176793) * pi) }, { x: 0.46657705708863173, y: 0.12174792367473619, f: \x -> 0.7047731530960449 * sin (0.39527154230290673 * (x + 0.5936262233984391) * pi) }, { x: 0.21703176126522317, y: 0.8930891192173489, f: \x -> 0.33641264539117166 * sin (0.4493531696446884 * (x + 0.2517156629417422) * pi) }, { x: 0.9174044923141177, y: 0.8817466776391724, f: \x -> 0.8454621762175387 * sin (0.115257536467252 * (x + 0.03469723233181332) * pi) }, { x: 0.04039986415756336, y: 0.15271145439316458, f: \x -> 0.9490449699465466 * sin (0.6750180669000483 * (x + 0.23431970196414276) * pi) }, { x: 0.5659642215562013, y: 0.33905297640111876, f: \x -> 0.5954679109024937 * sin (0.32255562390725917 * (x + 0.4103045663404872) * pi) }, { x: 0.5932269683893593, y: 0.04137646988081334, f: \x -> 0.43123850944012776 * sin (0.3503950236984895 * (x + 0.8751854149669083) * pi) }, { x: 0.2600532049644848, y: 0.9512335323594845, f: \x -> 0.1330852815646522 * sin (0.11685915493811834 * (x + 0.8032567255861771) * pi) }, { x: 0.750596919302173, y: 0.5660647811529884, f: \x -> 0.12252811048084478 * sin (0.4288900646165352 * (x + 0.8220020230866586) * pi) }, { x: 0.7058481499412821, y: 0.33577510035321756, f: \x -> 0.9309011132534613 * sin (0.10807387415279282 * (x + 0.5466506710634887) * pi) }, { x: 0.7560511451536488, y: 0.06454735707577242, f: \x -> 0.43828083133250995 * sin (0.4445668204142387 * (x + 0.054743827468044626) * pi) }, { x: 0.6481088042227873, y: 0.6090098373024916, f: \x -> 0.14389170336038942 * sin (0.33867071677250293 * (x + 0.4469693618232342) * pi) }, { x: 0.36024818355657573, y: 0.44495171974439407, f: \x -> 0.9902656439613039 * sin (0.3127988834819777 * (x + 0.9987847933230615) * pi) }, { x: 0.4948827944750618, y: 0.6429648291847946, f: \x -> 0.4301864871375427 * sin (0.6723415663046644 * (x + 0.09093914204530151) * pi) }, { x: 0.19745107701800912, y: 0.7921651204622543, f: \x -> 0.9097728915806184 * sin (0.1963810981662855 * (x + 0.7245090758938467) * pi) }, { x: 0.11912897419443358, y: 0.03254896045113975, f: \x -> 0.22994027602254857 * sin (0.6939778711871162 * (x + 0.7388155499569684) * pi) }, { x: 0.24415494669411641, y: 0.472570097337776, f: \x -> 0.22902259190972618 * sin (0.615227866357919 * (x + 0.9890480993112479) * pi) }, { x: 0.9203841664465398, y: 0.6208633185102296, f: \x -> 0.3143331078045957 * sin (0.6815435814010501 * (x + 0.057924771636933325) * pi) }, { x: 0.9811499004861685, y: 0.5022262463844889, f: \x -> 0.21672054629593676 * sin (0.6210527552028506 * (x + 0.7557243610589263) * pi) }, { x: 0.9677634098982452, y: 0.3901345287041713, f: \x -> 0.43036366949289895 * sin (0.4233216192964807 * (x + 0.31944166044882005) * pi) }, { x: 0.5786073690858976, y: 0.586371361406231, f: \x -> 0.13646859604175726 * sin (0.12072088512536519 * (x + 0.5010522848830792) * pi) }, { x: 0.0012499448415448366, y: 0.12587572124009438, f: \x -> 0.18469053046531844 * sin (0.42390239395966556 * (x + 0.1531961573744779) * pi) }, { x: 0.16895243179895392, y: 0.5277320979707424, f: \x -> 0.865882371139905 * sin (0.5691280576641032 * (x + 0.3324058336640292) * pi) }, { x: 0.801460966627075, y: 0.45910383316395653, f: \x -> 0.6598164595121057 * sin (0.5260478420336041 * (x + 0.6697376194661933) * pi) }, { x: 0.8521339389706153, y: 0.3626348770849186, f: \x -> 0.7924312976020662 * sin (0.2991814837291323 * (x + 0.909971642527428) * pi) }, { x: 0.674812734540027, y: 0.7277770593790434, f: \x -> 0.6762131320540856 * sin (0.5681512855133772 * (x + 0.5556219498125824) * pi) }, { x: 0.6491557825332536, y: 0.07308319042126221, f: \x -> 0.4735695380926135 * sin (0.40780536241728604 * (x + 0.5349601344729933) * pi) }, { x: 0.42464225237190634, y: 0.7069760605800132, f: \x -> 0.535850587398882 * sin (0.2955149383605018 * (x + 0.20791069400385453) * pi) }, { x: 0.20088096344665818, y: 0.09158856466883636, f: \x -> 0.483227501295338 * sin (0.6709549705061462 * (x + 0.4560022670904379) * pi) }, { x: 0.3001051588250363, y: 0.33328222376853534, f: \x -> 0.9773099994432405 * sin (0.2698851893399844 * (x + 0.004287367099682582) * pi) }, { x: 0.7865828579399956, y: 0.49798726608825594, f: \x -> 0.4015876199547852 * sin (0.5042292671040394 * (x + 0.8001839080045724) * pi) }, { x: 0.5559852141603664, y: 0.7666693336871541, f: \x -> 0.647911241286775 * sin (0.3930000983877372 * (x + 0.28698956153301447) * pi) }, { x: 0.34500972739493296, y: 0.5973390313634365, f: \x -> 0.6587863792858866 * sin (0.46869827306319156 * (x + 0.15114144868234736) * pi) }, { x: 0.23374379075588625, y: 0.7583632900663713, f: \x -> 0.7400567456600466 * sin (0.29787747244782165 * (x + 0.6753439286421234) * pi) }, { x: 0.6873905620914865, y: 0.5451169574060583, f: \x -> 0.11367639049636262 * sin (0.3297740241276462 * (x + 0.020127227356116162) * pi) }, { x: 0.3355756682713278, y: 0.9359876560341573, f: \x -> 0.7549390556872413 * sin (0.1449320748833887 * (x + 0.739847533268351) * pi) }, { x: 0.6276724894939283, y: 0.5668762277782079, f: \x -> 0.2656702822304661 * sin (0.16571984171700352 * (x + 0.8723894908240698) * pi) }, { x: 0.22465866093491016, y: 0.7129778383867211, f: \x -> 0.3545569459686496 * sin (0.5742628607823999 * (x + 0.5172389520132499) * pi) }, { x: 0.8575345791452911, y: 0.47901213109080476, f: \x -> 0.40539337284147625 * sin (0.34845123795736366 * (x + 0.5940440256190052) * pi) }, { x: 0.020995471036586055, y: 0.33573817904636394, f: \x -> 0.5670171907199093 * sin (0.13614960442098947 * (x + 0.27164164393555656) * pi) } ]

star :: Number -> Number -> (Number -> Number) -> Number -> Number -> Number -> Painting
star x y f w h t = let c = floor $ calcSlope (-1.0) 120.0 1.0 255.0 (f t) in filled (fillColor (rgb c c c)) (circle (x * w) (y * h) 1.0)

starFs = map (\{ x, y, f } -> star x y f) starDs :: Array (Number -> Number -> Number -> Painting)
